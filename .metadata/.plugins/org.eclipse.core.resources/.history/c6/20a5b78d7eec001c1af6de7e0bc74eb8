package projectmidterm.graph;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;

public class Graph {
	private HashMap<Vertex, List<Vertext>> adj = new HashMap<Vertext, List<Vertext>>();
	private boolean isDirected = false;
	public Graph() {
		super();
	}
	public Graph(boolean isDirected) {
		super();
		this.isDirected = isDirected;
		Vertext.resetId();
	}
	public HashMap<Vertext, List<Vertext>> getAdj() {
		return adj;
	}
	public Vertext getVertext(int id) {
		for (Vertext key : adj.keySet()) {
		    if(key.getId() == id) 
		    	return key;
		}
		return null;
	}
	public void addVertext(Vertext vertext) {
		if(adj.containsKey(vertext)) {
			System.out.println("This vertext has already been added to the graph");
		} else {
			adj.put(vertext, new ArrayList<Vertext>());
			System.out.println("Add successfully vertext " + vertext.getId());
		}
	}
	public void deleteVertext(int id) {
		Vertext v = getVertext(id);
		if(v != null) {
			adj.remove(v);
			System.out.println("Remove successfully vertext " + id);
			Vertext.addToDeletedStack(id);
			return;
		}
		System.out.println("This vertext is not exist");
	}
	public void addEdge(int from, int to) {
		Vertext fromVertext = getVertext(from);
		Vertext toVertext = getVertext(to);
		if(adj.containsKey(fromVertext)) {
			if(adj.get(fromVertext).contains(toVertext)) {
				System.out.println("This edge has already been added to the graph");
			}
			adj.get(fromVertext).add(toVertext);
		} else {
	        List<Vertext> tempVertextList = new ArrayList<Vertext>();
	        tempVertextList.add(toVertext);
        	adj.put(fromVertext, tempVertextList);
		}
		if(!isDirected) {
			if(adj.containsKey(toVertext)) {
				adj.get(toVertext).add(fromVertext);
			} else {
		        List<Vertext> tempVertextList = new ArrayList<Vertext>();
		        tempVertextList.add(fromVertext);
	        	adj.put(toVertext, tempVertextList);
			}
		}
    	System.out.println("Add edge successfully edge " + from + " --" + to);
	}
	public void deleteEdge(int from, int to) {
		Vertext fromVertext = getVertext(from);
		Vertext toVertext = getVertext(to);
		if(fromVertext == null || toVertext == null) {
			System.out.println("This edge not exists");
			return;
		}
		adj.get(fromVertext).remove(toVertext);
		System.out.println("Remove successfully edge " + to + " --- " + from);
		if(!isDirected) {
			adj.get(toVertext).remove(fromVertext);
			System.out.println("Remove successfully edge " + from + " --- " + to);
		}
	}
}
